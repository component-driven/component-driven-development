import { jsx, Flex, Box } from 'theme-ui';
import {
	Appear,
	Boom,
	Center,
	Code,
	Cover,
	Demo,
	Image,
	Notes,
	LiveCode,
	List,
	Primary,
	Secondary,
	Split,
	SplitWithHeading,
	ThatGuy,
} from './theme';
import { Prism } from 'react-syntax-highlighter';
import TweetEmbed from 'react-tweet-embed';
import Stack from 'stack-styled';
import * as dropdown from './code/dropdown.js';

export { theme } from './theme';

<Cover author="Andrey Okonetchnikov">

# Resilient Component Libraries with React

</Cover>

---

<Center>

## My name is Andrey

I design & develop user interfaces on the Web since 1999

</Center>

---

<Secondary>

# User Interface Design & Development

</Secondary>

---

// TODO: Tell a story of this wireframe

<Image src={require('file-loader!./assets/wireframe.jpg')} size="contain" />

---

### How to build a UI

1. Get a static mockup from a designer
1. Write HTML markup that represents the mockup
1. Write CSS and connect with HTML using classes
1. "Sprinkle" JavaScript using classes to add interactivity
1. Hand off to a backend developer
1. Replace HTML with PHP, Ruby, Java, ...
1. ...
1. Profit

---

<Center>

Fast forward 20 years...

</Center>

---

### How to build a UI with React

1. Get a static mockup from a designer
1. Get data from API endpoint
1. Render data in JSX using HTML
1. Write CSS and connect with JSX using `className`
1. ...
1. Profit

---

<Secondary>

> Designers are still drawing **static mockups** and developers are writing **HTML & CSS**

</Secondary>

---

<Secondary>

# What's the problem with static mockups?

</Secondary>

---

<Image src={require('file-loader!./assets/dribbble1.png')} size="contain" />

---

<Image src={require('file-loader!./assets/dribbble2.png')} size="contain" />

---

## Static mockups...

1. not covering all possible states
1. not covering all possible resolutions
1. losing lots of design knowledge during ~~translation~~ hand-off
1. are static!

---

<Boom>

## Mockups are **static**

## Applications are **dynamic**

</Boom>

---

<Secondary>

## What's the problem with HTML?

</Secondary>

---

<Boom>

> HTML was designed for documents, not applications!

</Boom>

---

<Stack gridGap={5} p={4} gridTemplateColumns="auto 1fr auto">
	<span>Text, Heading</span>
	<Code language="html">{`<h1>Heading</h1>
<p>Text</p>`}</Code>
	<span>Ô∏èüòä</span>
	<span>Link</span>
	<Code language="html">{`<a href="#">Link</a>`}</Code>
	<span>ü§î</span>
	<span>Button</span>
	<Code language="html">
		{`<button>Button</button>
<input type="button">Button</input>`}
	</Code>
	<span>üôÑ</span>
	<span>Dropdown</span>
	<Code language="html">{dropdown.html}</Code>
	<span>üò©</span>
</Stack>

---

<Image
	src={require('file-loader!./assets/bootstrap-dropdown.png')}
	size="contain"
/>

<ThatGuy />

---

<Secondary>

# Is there a better way?

</Secondary>

---

<Boom>

> Components is a better way of writing HTML

</Boom>

---

<Center>

# Components

- `<Button>` ‚Üí `<button>`
- `<Input>` ‚Üí `<input type="text">`
- `<Checkbox>` ‚Üí `<input type="checkbox">`
- `<Dropdown>` ‚Üí ~~`<select>`~~ `<div class="dropdown">...`

</Center>

---

<SplitWithHeading>

## HTML & CSS vs. Components

<Code language="html">{dropdown.html}</Code>

<Code language="jsx">{dropdown.jsx}</Code>

</SplitWithHeading>

---

<SplitWithHeading>

## Components can change over time

```jsx harmony
const Dropdown = props => (
	<select>
		{props.options.map(option => (
			<option>{option}</option>
		))}
	</select>
);
```

```jsx harmony
const Dropdown = props => (
	<div className="dropdown">
		<button class="btn btn-dropdown">{props.button}</button>
		<ul>
			{props.options.map(option => (
				<li>{option}</li>
			))}
		</ul>
	</div>
);
```

</SplitWithHeading>

---

# Components as a common language

<Stack gridGap={5} p={4} gridTemplateColumns="1fr 1fr">
	<span>A button</span>
	<Code language="jsx">{`<Button>`}</Code>
	<span>A primary button</span>
	<Code language="jsx">{`<Button primary>`}</Code>
	<span>A cheked checkbox</span>
	<Code language="jsx">{`<Checkbox checked>`}</Code>
	<span>A product card</span>
	<Code language="jsx">{`<ProductCard>`}</Code>
</Stack>

---

<Boom>

> Components as a common UI language

</Boom>

---

## Watch my talk

// TODO

---

<Secondary>

## What's the problem with CSS?

</Secondary>

---

<Boom>

# CSS is hard ü§Ø

</Boom>

---

<Center>
	<TweetEmbed id="1038073603311448064" />
	<ThatGuy />
</Center>

---

<Boom>

# CSS is the source of inconsistent UIs

</Boom>

---

<Image src={require('file-loader!./assets/doors.jpg')} />

---

## Sources of inconsistent UIs

1. Color & Typography
1. Spacing & Layout

---

<SplitWithHeading>

## Custom CSS

```css
.description {
	margin-bottom: 20px;
	font-size: 16px;
	color: #c9b8b9;
}
```

```css
.count {
	margin-left: 0.75em;
	font-size: 14px;
	opacity: 0.5;
	color: #fc9;
}
```

</SplitWithHeading>

---

// TODO: Add video of long CSS file

---

<Image
	src={require('file-loader!./assets/too-many-buttons.jpg')}
	size="contain"
/>

---

<Image
	src={require('file-loader!./assets/too-many-buttons-2.jpg')}
	size="contain"
/>

---

<Image src={require('file-loader!./assets/text.png')} size="contain" />

---

<Boom>

# CSS is too expressive üë©‚Äçüé®

</Boom>

---

<Secondary>

## What should we do?

</Secondary>

---

<Boom>

# Stop writing CSS!

</Boom>

---

<Primary>

# Design tokens

</Primary>

---

<Center>
	<Image
		src={require('file-loader!./assets/dls-foundation.png')}
		size="contain"
	/>
</Center>

---

<Boom>

> Design tokens are everything you use more than once in your styles

</Boom>

---

<Center>

# Documenting design tokens

</Center>

---

<Center>
	<Code language="javascript">
		{require('!raw-loader!./code/themeExample.js').default}
	</Code>
</Center>

---

<Center>
	<a href="https://marvelapp.com/styleguide/design/color-scheme">
		<img
			src={require('file-loader!./assets/design-tokens-colors.png')}
			alt="Design tokens: colors"
		/>
	</a>
</Center>

---

<Center>
	<a href="https://cloudflare.github.io/cf-ui/#cf-design-gradients">
		<img
			src={require('file-loader!./assets/design-tokens-gradients.png')}
			alt="Design tokens: gradients"
		/>
	</a>
</Center>

---

<Center>
	<a href="https://vueds.com/example/#!/Design%20Tokens">
		<img
			src={require('file-loader!./assets/design-tokens-fonts-spacing.png')}
			alt="Design tokens: fonts and spacing"
		/>
	</a>
</Center>

---

<Center>
	<a href="https://www.lightningdesignsystem.com/design-tokens/">
		<img
			src={require('file-loader!./assets/design-tokens-misc.png')}
			alt="Design tokens"
		/>
	</a>
</Center>

---

<Demo src="http://localhost:6060" />

---

<Secondary>

## How can we enforce usage of design tokens?

</Secondary>

---

<Primary>

# Primitive components

</Primary>

---

<Image src={require('file-loader!./assets/legos.jpg')} />

---

<Boom>

> Primitives are the building blocks of the user interface.

</Boom>

---

<Image src={require('file-loader!./assets/legos-assembled.jpg')} />

---

<Primary>

# Basic Primitives

</Primary>

---

<Center>

# React way‚Ñ¢

</Center>

---

<Center>

<Code language="jsx" inline>{`<button onclick={handleClick} />`}</Code>

vs.

<Code language="jsx" inline>{`<Button onClick={handleClick} />`}</Code>

</Center>

---

<Center>

<Code
	language="jsx"
	inline
>{`<font face="Arial" size="3" color="red" />`}</Code>

vs.

<Code
	language="jsx"
	inline
>{`<Text fontFace="base" fontSize={3} color="danger" />`}</Code>

</Center>

---

<Boom>

> Learn once, use everywhere

</Boom>

---

<Center>

## CSS + React way‚Ñ¢ = styled-system

</Center>

---

<Center>
	<a href="https://styled-system.com">
		<img
			src={require('file-loader!./assets/styled-system.png')}
			alt="Styled-system Webiste"
		/>
	</a>
</Center>

---

<Boom>

> Styled System lets you quickly build custom UI components with constraint-based style props based on scales defined in your theme.

</Boom>

---

<Secondary>

# Text

</Secondary>

---

## API design

Things developers will be allowed to customize

- Typography (`fontSize`, `fontWeight`, `letterSpacing`, etc.)
- Alignment (`left`, `center`, `right`, ~~`justify`~~)
- Color (`color`)
- Whitespace (`margin`)
- HTML elements (`p`, `span`, `label`)

---

<Boom>

> Define a minimal set of props that can be customized

</Boom>

---

<Center>

```javascript
import styled from '@emotion/styled';
import { color, margin, typography } from 'styled-system';

export const Text = styled.p(
	// defaults
	{
		m: 0,
		lineHeight: 1.5,
	},
	// API
	color,
	typography,
	margin
);
```

</Center>

---

<Center>

```javascript
import Text from '../primitives/Text';

<Text color="danger" fontWeight="bold">
	Bold red text
</Text>;
```

</Center>

---

<Image src={require('file-loader!./assets/text.png')} size="contain" />

---

## Necessary text styles

<ul>
	<li>
		<h1 style={{ textAlign: 'left' }}>Heading 1</h1>
	</li>
	<li>
		<h2 style={{ textAlign: 'left' }}>Heading 2</h2>
	</li>
	<li>Normal text</li>
	<li style={{ color: '#979797', fontSize: '80%' }}>Secondary text</li>
	<li style={{ color: '#930' }}>Error</li>
	<li>etc.</li>
</ul>

---

<Boom>

> UI inventory helps with defining what's necessary

</Boom>

---

## API: boolean vs variant

- `<Text primary>` üòÄ
- `<Text secondary>` üòÄ
- `<Text primary secondary>` ü§Ø

---

## API: boolean vs variant

- `<Text variant="primary">` üòÄ
- `<Text variant="secondary">` üòÄ
- ~~`<Text variant="primary secondary">`~~ üö´
- `<Button variant="primary" disabled>` üòÄ
- `<Button variant="secondary" disabled>` üòÄ

---

<Boom>

> Variants make impossible states impossible

</Boom>

---

<Center>

```diff
	import styled from '@emotion/styled';
+	import { color, margin, typography, variant } from 'styled-system';

+	export const textStyles = {
+	  primary: {
+		fontSize: 2,
+		color: "text",
+	  },
+	  secondary: {
+		fontSize: 1,
+		color: "secondary",
+	  },
+	}

	export const Text = styled.p(
		// defaults
		{
			m: 0,
			lineHeight: 1.5,
		},
		// API
		color,
		typography,
		margin,
+		variant({ variants: textStyles }), // Adds `variant` prop
	);
```

</Center>

---

<Center>

```javascript
import Text from '../primitives/Text';

<Text variant="secondary">Secondary text</Text>;
```

</Center>

---

## API: rigidity vs flexibility

- `<Text variant="error">` üòÄ
- `<Text color="red" size="xs">` üòÄ
- `<Text variant="muted" sx={{ letterSpacing: 'caps' }} >` ü§ì

---

<Boom>

> Make primitives flexible to not block you

</Boom>

---

## API: HTML element

- `<Text>` ‚Üí `<p>` üòÄ
- `<Text inline>` ‚Üí `<span>` üòê
- `<Text label>` ‚Üí `<label>` üò≠
- `<Text as="label">` ‚Üí `<label>` üòÄ

---

<Boom>

> Primitives can be rendered anywhere

</Boom>

---

<LiveCode
	title="Example"
	code={require('!raw-loader!./code/Text.js').default}
	size="fullscreen"
/>

---

<Secondary>

# Box

</Secondary>

---

## API design

- Layout (`width`, `height`, etc.)
- White space (`margin`, `padding`)
- Colors (`background`, `color`)
- Borders (`border`, `border-radius`),
- Shadows (`box-shadow`),
- HTML elements (`div`, `span`, `section`, ...)

---

<Center>

```javascript
import styled from '@emotion/styled';
import { layout, space, color, border, boxShadow } from 'styled-system';

export const Box = styled.div(
	// defaults
	{
		minWidth: 0,
	},
	// API
	layout,
	space,
	color,
	border,
	boxShadow
);
```

</Center>

---

<LiveCode
	title="Box"
	code={require('!raw-loader!./code/Box.js').default}
	size="fullscreen"
/>

---

<Boom>

> Model API based on CSS knowledge

</Boom>

---

<Secondary>

# Responsive design

</Secondary>

---

<Center>

**Prop per breakpoint** vs. **all props are responsive**

</Center>

---

<Center>
<Split>

```jsx
<Row>
	<Col xs={12} md={6} lg={3}>
		Pizza
	</Col>
</Row>
```

```jsx
// breakpoints: [small, medium, large]
<Box width={[1, 1 / 2, 1 / 4]} p={['sm', 'md', 'lg']}>
	Pizza
</Box>
```

</Split>
</Center>

---

<LiveCode
	title="Box"
	code={require('!raw-loader!./code/responsive.js').default}
	size="fullscreen"
/>

---

<Center>

Now let's compose primitives...

</Center>

---

<LiveCode
	title="Box"
	code={require('!raw-loader!./code/Box-Text.js').default}
	size="fullscreen"
/>

---

<Primary>

# Layout Primitives

</Primary>

---

<Boom>

> Primitives to control space around their children

</Boom>

---

<Secondary>

# Flex

</Secondary>

---

## Flexbox layout

```jsx
<Flex
	alignItems="center"
	justifyContent="center"
	flexDirection="row"
	flexWrap="wrap"
/>
```

---

<LiveCode
	title="Flex"
	code={require('!raw-loader!./code/Flex.js').default}
	size="fullscreen"
/>

---

<Secondary>

# Grid

</Secondary>

---

<LiveCode
	title="Grid"
	code={require('!raw-loader!./code/Grid.js').default}
	size="fullscreen"
/>

---

<Secondary>

# Stack

</Secondary>

---

<LiveCode
	title="Stack"
	code={require('!raw-loader!./code/Stack.js').default}
	size="fullscreen"
/>

---

<Boom>

> Primitives should not have any whitespace around them!

</Boom>

---

<Secondary>

# Group

</Secondary>

---

<LiveCode
	title="Stack"
	code={require('!raw-loader!./code/Group.js').default}
	size="fullscreen"
/>

---

<Primary>

# Composition

</Primary>

---

## API: Composition

- `<Heading>` ‚Üí `<Text variant="heading" as="h1">`
- `<Label>` ‚Üí `<Text variant="label" as="label">`
- `<Error>` ‚Üí `<Text color="error" as="p">`

---

<Boom>

> Primitives are meant to be composed

</Boom>

---

<Secondary>

# Demo

</Secondary>

---

<Demo src="http://localhost:3000" />

---

<Demo src="http://localhost:6060" />

---

<Primary>

# Recap

</Primary>

---

# Recap

- Components are a common UI language
- Components is a better way of writing HTML & CSS
- Use design tokens to reduce choice
- Use primitive components (Text, Box)
- Do not make any assumptions about where your components are going to be used
- Use layout primitives to control the white space (Flex, Grid, Stack, Group, ...)
- Compose complex components using primitives

---

<Secondary>

# Dreaming about UI development

</Secondary>

---

## Building UIs with primitives & patterns

1. Get a ~~static mockup~~ wireframe from a designer
1. Get data from API endpoint
1. Assembly UI using primitives or re-use a pattern.
1. ...
1. Profit

---

<Image src={require('file-loader!./assets/napkin.jpg')} size="contain" />

---

// TODO: Find the tweet by John Gold with the AI scanning drawing of wireframes

---

<Primary>

# Thank you and let components be with you!

</Primary>
